<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
   <title>Calculator</title>
   <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500&display=swap" rel="stylesheet">
   <style>
       * { margin: 0; padding: 0; box-sizing: border-box; }
       body {
           display: flex; align-items: center; justify-content: center;
           height: 100vh; background-color: #f4f4f4;
           font-family: 'Poppins', sans-serif;
       }
       .container {
           width: 100%; max-width: 380px; background: white;
           padding: 15px; border-radius: 8px;
           box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
           display: flex; flex-direction: column; gap: 12px;
       }
       .field { display: flex; flex-direction: column; gap: 4px; }
       label { font-weight: 500; }
       .input-wrapper {
           display: flex; position: relative;
       }
       .input-wrapper span {
           position: absolute; left: 10px; font-weight: bold;
       }
       input {
           width: 100%; padding: 10px 10px 10px 30px;
           border: 1px solid #ccc; border-radius: 5px;
       }
       .row { display: flex; gap: 8px; }
   </style>
</head>
<body>
   <div class="container">
       <div class="field">
           <label>Purchase Price (€)</label>
           <input type="number" id="purchasePrice" oninput="calculate()">
       </div>
       <div class="field">
           <label>Discount (%)</label>
           <input type="number" id="discount" oninput="calculate()">
       </div>
       <div class="row">
           <div class="field">
               <label>Margin (€)</label>
               <input type="number" id="profitAmount" oninput="calculate()">
           </div>
           <div class="field">
               <label>Margin (%)</label>
               <input type="number" id="profitMargin" oninput="calculate()">
           </div>
       </div>
       <div class="row">
           <div class="field">
               <label>Net Price (€)</label>
               <input type="number" id="sellPriceExcl" readonly>
           </div>
           <div class="field">
               <label>Sell Price (€)</label>
               <input type="number" id="sellPriceIncl" oninput="calculate()">
           </div>
       </div>
   </div>

   <script>
       function calculate() {
           let purchasePrice = parseFloat(document.getElementById('purchasePrice').value) || 0;
           let discount = parseFloat(document.getElementById('discount').value) || 0;
           let profitMargin = parseFloat(document.getElementById('profitMargin').value) || 0;
           let profitAmount = parseFloat(document.getElementById('profitAmount').value) || 0;
           let sellPriceIncl = parseFloat(document.getElementById('sellPriceIncl').value) || 0;

           let discountedPrice = purchasePrice * (1 - discount / 100);
           let sellPriceExcl = discountedPrice * (1 + profitMargin / 100);
           let finalSellPriceIncl = sellPriceExcl * 1.21;

           document.getElementById('sellPriceExcl').value = sellPriceExcl.toFixed(2);
           document.getElementById('sellPriceIncl').value = finalSellPriceIncl.toFixed(2);

           if (profitMargin > 0) {
               document.getElementById('profitAmount').value = (sellPriceExcl - discountedPrice).toFixed(2);
           }
           if (profitAmount > 0) {
               sellPriceExcl = discountedPrice + profitAmount;
               finalSellPriceIncl = sellPriceExcl * 1.21;
               document.getElementById('profitMargin').value = ((profitAmount / sellPriceExcl) * 100).toFixed(2);
               document.getElementById('sellPriceExcl').value = sellPriceExcl.toFixed(2);
               document.getElementById('sellPriceIncl').value = finalSellPriceIncl.toFixed(2);
           }
           if (discount > 0) {
               document.getElementById('sellPriceIncl').value = finalSellPriceIncl.toFixed(2);
               document.getElementById('sellPriceExcl').value = sellPriceExcl.toFixed(2);
           }
           if (discount === 0) {
               document.getElementById('discount').value = 0;
               calculate();
           }
       }
   </script>
</body>
</html>
